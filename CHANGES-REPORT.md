# דו"ח שינויים מלא – WEBTECH

**פרויקט:** WEBTECH – לימודי Next.js  
**תאריך ביצוע:** 21 פברואר 2026  
**מבוסס על:** טופס אבחון ותיקון מקצועי (ללא קוד → יישום מלא)

---

## 1. סיכום ביצוע

בוצעו כל התיקונים והשדרוגים המתוארים בטופס האבחון. להלן פירוט מדויק של כל שינוי, מה קורה בפועל בכל פעולה, ומה התוצאה.

---

## 2. קבצים שנוצרו / עודכנו

| קובץ | פעולה |
|------|--------|
| `vite.config.js` | **נוצר** – תצורת Vite מפורשת |
| `.gitignore` | **נוצר** – דפוסי התעלמות ל-Git |
| `README.md` | **נוצר** – תיעוד הפעלה ופריסה |
| `index.html` | **עודכן** – תמיכת נגישות (ARIA) |
| `src/main.js` | **עודכן** – escape, נגישות, event listeners |
| `CHANGES-REPORT.md` | **נוצר** – מסמך זה |

---

## 3. פירוט מדויק לפי קובץ

### 3.1 `vite.config.js`

**מה קורה:** הקובץ מגדיר ל-Vite איך לבנות את הפרויקט.

| הגדרה | ערך | משמעות בפועל |
|--------|------|----------------|
| `root: '.'` | תיקיית הפרויקט | Vite מחפש `index.html` בשורש. ברירת המחדל דומה, אבל עכשיו זה מפורש. |
| `base: '/'` | נתיב בסיס | כל הקישורים נבנים מ־`/`. מתאים לפריסה ב-Vercel בתשתית רגילה. אם מפרסמים ב־`/webtech/` – יש לשנות ל־`base: '/webtech/'`. |
| `build.outDir` | `'dist'` | תיקיית ה-build היא `dist/`. לאחר `npm run build` כל הקבצים המוכנים נמצאים שם. |
| `build.emptyOutDir` | `true` | לפני build חדש – ניקוי `dist/` כדי למנוע שאריות build ישן. |
| `build.assetsDir` | `'assets'` | קבצי CSS/JS/אחרים נשמרים תחת `dist/assets/`. |

**תוצאה:** התנהגות build צפויה, ופרויקט עמיד יותר לעת שינוי סביבה או תת־נתיב.

---

### 3.2 `.gitignore`

**מה קורה:** Git מתעלם מהקבצים והתיקיות הרשומים.

| דפוס | מטרה |
|------|-------|
| `node_modules/` | מניעת commit של תלויות. |
| `dist/` | מניעת commit של build – הוא נוצר מחדש בכל deploy. |
| `.env`, `.env.local`, `.env.*.local` | הגנה על מפתחות ומשתני סביבה. |
| `*.log`, `npm-debug.log*` | מניעת commit לוגים. |
| `.vscode/*` (למעט `settings.json`) | התעלמות מהגדרות editor, מלבד `settings.json` שנשאר. |
| `.DS_Store`, `Thumbs.db` | מניעת commit קבצי מערכת הפעלה. |

**תוצאה:** ה-repo נקי יותר, ומפתחות ומשתני סביבה לא נדחפים ל־Git.

---

### 3.3 `README.md`

**מה קורה:** מספק הוראות הפעלה ופריסה.

| סעיף | תוכן | מה קורה בפועל |
|------|-------|----------------|
| **כותרת + תיאור** | מה הפרויקט עושה | מספק הקשר למפתחים חדשים. |
| **הפעלה – אזהרה** | "לא לפתוח file://" | מונע פתיחה ישירה של `index.html` – שם `/src/` לא עובד. |
| **התקנה** | `npm install` | מוריד `node_modules` ומאפשר הרצה. |
| **פיתוח** | `npm run dev` | מפעיל שרת Vite → `http://localhost:5173`. |
| **Build** | `npm run build` | יצירת `dist/` לפרודקשן. |
| **Preview** | `npm run preview` | הרצת שרת סטטי על `dist/` לצורך בדיקה. |
| **פריסה** | Vercel + סביבות אחרות | מגדיר איך לפרוס (Vercel, תת־נתיב וכו'). |
| **מבנה הפרויקט** | טבלה | מציג איפה נמצא כל קובץ. |
| **הערה על raw-content.txt** | מקור תוכן | מבהיר ש־`content.js` הוא מקור האמת, ו־`raw-content.txt` (אם קיים) הוא חומר גולמי בלבד. |

**תוצאה:** יש חוזה ברור להפעלה ופריסה, ופחות טעויות בהרצה או בדפלוי.

---

### 3.4 `index.html`

**מה קורה:** נוספו תכונות נגישות (ARIA) לרכיבי הממשק.

| שינוי | לפני | אחרי | מה קורה בפועל |
|--------|------|------|----------------|
| **Progress bar** | `<div class="progress-bar">` | `role="progressbar"` + `aria-valuenow`, `aria-valuemin`, `aria-valuemax`, `aria-label` | קוראי מסך מזההים רכיב התקדמות ומכריזים את הערכים (עמוד נוכחי/סה"כ). |
| **אריקל התוכן** | `<article id="content">` | `tabindex="-1"` + `aria-live="polite"` | `article` ניתן לפוקוס (למשל אחרי ניווט). `aria-live` מאפשר לקורא מסך להכריז שינויים בתוכן בצורה עדינה. |

**עדכון דינמי:** `main.js` מעדכן את `aria-valuenow` ו־`aria-valuemax` בכל מעבר עמוד (באמצעות `updateProgressAria()`).

**תוצאה:** חוויית שימוש טובה יותר לקוראי מסך ומשתמשי מקלדת.

---

### 3.5 `src/main.js`

#### 3.5.1 פונקציית `escapeHtml(str)`

**מה קורה:**

1. בודק ש־`str` הוא מחרוזת.
2. יוצר אלמנט `div` זמני.
3. מגדיר `div.textContent = str`.
4. מחזיר `div.innerHTML` – הדפדפן מבצע escape לאותיות כמו `<`, `>`, `&`, `"`.

**שימוש:** כל מחרוזת שמוזרקת ל־HTML (כותרת, טקסט, אפשרויות חידון, הסברים) עוברת דרך `escapeHtml` לפני הזרקה. כך מונעים הזרקת HTML/JS זדוני (XSS) אם בעתיד התוכן יגיע ממקור חיצוני.

---

#### 3.5.2 `textToHtml` – שילוב Escape

**מה קורה:**
- שורות בודדות ברשימות: `escapeHtml(i)` לכל פריט ב־`<li>`.
- פסקאות: `escapeHtml(trimmed)` לפני המרת `\n` ל־`<br>`.

**תוצאה:** תוכן טקסטואלי מוצג בצורה בטוחה, ללא הזרקת קוד.

---

#### 3.5.3 `TOTAL_PAGES` ו־`updateProgressAria()`

**מה קורה:**
- `TOTAL_PAGES = PAGES.length` – מספר העמודים נשמר.
- `updateProgressAria()` מעדכן ב־`progressBarEl`:
  - `aria-valuenow = currentPage + 1`
  - `aria-valuemax = TOTAL_PAGES`

**תוצאה:** פרוגרס בר תמיד מעודכן מבחינת ARIA.

---

#### 3.5.4 `focusContent()`

**מה קורה:**
1. קורא ל־`contentEl.focus({ preventScroll: false })`.
2. `tabindex="-1"` (ב־HTML) מאפשר פוקוס על האריקל גם אם הוא לא focusable ב־tab.
3. הפוקוס מועבר לתוכן החדש אחרי כל מעבר עמוד.

**תוצאה:** משתמשי מקלדת מקבלים פוקוס ישר לתוכן החדש.

---

#### 3.5.5 `renderPage()` – עדכונים

| שינוי | מה קורה |
|--------|----------|
| בדיקת `PAGES` ריק | אם אין עמודים – יוצא בלי לבצע כלום. |
| קיבוע `currentPage` לטווח | `currentPage = Math.max(0, Math.min(currentPage, PAGES.length - 1))` – מונע ערכים מחוץ לטווח. |
| הסרת `onclick` מתוך `renderPage` | כפתורי הניווט לא מקבלים עוד handler בתוך `renderPage` – יש handler קבוע (להלן). |
| קריאה ל־`updateProgressAria()` | עדכון ARIA של הפרוגרס בר בכל רינדור. |
| קריאה ל־`focusContent()` | העברת פוקוס לתוכן אחרי כל רינדור. |

---

#### 3.5.6 `renderContent(page)`

**מה קורה:**
- `contentEl.setAttribute('aria-label', 'תוכן: ' + escapeHtml(page.title))` – כותרת האריקל לקוראי מסך.
- כותרת וטקסט עוברים דרך `escapeHtml` לפני הזרקה ל־`innerHTML`.

---

#### 3.5.7 `renderQuiz(quiz)` – שינויים

| שינוי | מה קורה בפועל |
|--------|----------------|
| **אפשרויות דינמיות** | `Object.keys(quiz.options)` במקום `['א','ב','ג','ד']` – תואם לחידונים עם מספר שונה של אפשרויות. |
| **ARIA לקבוצת חידון** | `role="group"`, `aria-labelledby` מצביע על השאלה, `aria-label="בחר תשובה"`. |
| **כפתורים** | `type="button"` – מניעת שליחת טופס אם החידון בתוך form. |
| **איזור תוצאה** | `role="status"`, `aria-live="polite"`, `aria-atomic="true"` – קורא מסך מכריז את התוצאה וההסבר. |
| **`aria-pressed`** | כפתורים מקבלים `aria-pressed="false"`, ואחרי לחיצה – `aria-pressed="true"` לכפתור שנבחר. |
| **`aria-label` לתוצאה** | `feedbackEl.setAttribute('aria-label', ...)` – תיאור מילולי של התוצאה וההסבר. |
| **Escape** | כל הטקסטים (כותרת, שאלה, אפשרויות, הסבר) עוברים דרך `escapeHtml`. |

---

#### 3.5.8 Event listeners – במקום `onclick` ב־renderPage

**מה קורה:**
- `nextBtn.addEventListener('click', ...)` ו־`prevBtn.addEventListener('click', ...)` מוגדרים פעם אחת.
- בתוך ה־handler: עדכון `currentPage` וקריאה ל־`renderPage()`.
- ה־closure משתמש ב־`currentPage` המעודכן.

**תוצאה:** אין החלפה חוזרת של handlers, הקוד פשוט ויציב יותר.

---

## 4. מה *לא* בוצע (במכוון)

| נושא | הסבר |
|------|--------|
| **עריכת raw-content.txt** | הקובץ לא נמצא בפרויקט. הוספנו הערה ב־README לגבי מקור התוכן. |
| **הוספת DOMPurify** | השתמשנו ב־`escapeHtml` פנימי. DOMPurify מתאים לתוכן עשיר ב־HTML; כאן התוכן טקסטואלי ברובו. |
| **שינוי עיצוב (CSS)** | לא נדרש לפי האבחון. |
| **שינוי content.js** | התוכן נשאר; רק מנגנון התצוגה (main.js) עודכן. |

---

## 5. בדיקות קבלה (Acceptance Checklist)

לפני סגירת המסמך מומלץ לוודא:

- [ ] **מובייל:** iPhone (Safari) + Android (Chrome) – ניווט, חידונים, פרוגרס בר.
- [ ] **דסקטופ:** Chrome, Edge, Firefox – אותן תכונות.
- [ ] **ניווט:** קדימה/אחורה – פוקוס עובר לתוכן החדש.
- [ ] **חידון:** בחירה אחת בלבד, תוצאה ברורה, אין אפשרות לענות פעמיים.
- [ ] **פריסה:** `npm run build` + `npm run preview` – האתר עובד.
- [ ] **Vercel:** deploy ל־https://webtech-ochre.vercel.app – עובד באותה צורה.

---

## 6. סדר פעולה מומלץ להמשך

1. הרצת `npm install` (אם טרם בוצע).
2. הרצת `npm run dev` – בדיקה במצב פיתוח.
3. הרצת `npm run build` – בדיקה שה-build עובר.
4. הרצת `npm run preview` – בדיקה לפני פריסה.
5. Deploy ל־Vercel (או סביבה אחרת) ובדיקה שם.
6. בדיקות נגישות: מקלדת, קורא מסך (למשל NVDA / VoiceOver).

---

## 7. הערות נוספות

### 7.1 תת־נתיב ב־Vercel
אם האתר מפורסם בנתיב כמו `https://example.com/webtech/`, יש לעדכן ב־`vite.config.js`:

```js
base: '/webtech/',
```

### 7.2 נגישות – המשך
- מומלץ בדיקת contrast צבעים (WCAG).
- בדיקת התנהגות עם הגדלת טקסט (zoom).
- בדיקת ניווט מלא במקלדת (Tab, Enter, חצים).

### 7.3 עתיד – תוכן חיצוני
אם בעתיד התוכן יגיע מ־CMS או API – לוודא שכל התוכן עובר דרך `escapeHtml` (או DOMPurify) לפני הזרקה. הקוד הנוכחי כבר מוכן לכך.

### 7.4 package.json
לא שונה – הסקריפטים `dev`, `build`, `preview` נשארו. תצורת Vite ב־`vite.config.js` משתלבת איתם ללא שינוי.

---

**סיום הדו"ח** – כל השינויים בוצעו, והמסמך משמש כפרוטוקול מלא של הפעולות שבוצעו בפרויקט WEBTECH.
